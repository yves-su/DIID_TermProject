# SmartRacket Labeling Tool - 使用說明書 (User Manual)

## 1. 軟體簡介
這是一個專為羽球動作分析設計的標註工具。它可以同步顯示影片與 6 軸傳感器 (IMU) 的波形數據，協助使用者精確標記擊球瞬間。

**主要功能：**
*   **同步播放**：MP4 影片與 IMU 數據同步捲動。
*   **精確標註**：支援 5 種動作類別 (Smash, Drive, Toss, Drop, Other)。
*   **智慧導航**：自動尋找下一個加速度波峰，加速標註流程。
*   **視覺回饋**：提供標註範圍的視覺化顯示 (淡灰色區域)。
*   **自動存檔**：標註結果自動儲存為 JSONL 格式。

---

## 2. 快速開始 (Quick Start)

### 步驟 1: 載入資料
1.  開啟程式。
2.  點選選單 `File` -> `Load Video...` 選擇您的動作影片 (.mp4)。
3.  點選選單 `File` -> `Load CSV files...` 選擇對應的 IMU 數據檔 (.csv)。
    *   *注意：程式會自動將數據重採樣 (Resample) 至 50Hz。*

### 步驟 2: 訊號同步 (Alignment)
由於影片與傳感器啟動時間不同，需手動對齊：
1.  **設定起點 (Anchor A)**:
    *   在影片中找到第一個明顯動作（例如如果敲擊球拍）。
    *   在波形圖中找到對應的波峰。
    *   點擊 `Set Anchor A (Start)`。
2.  **設定終點 (Anchor B)** (選用，修正時間漂移):
    *   在影片末段找另一個動作。
    *   在波形圖找到對應波峰。
    *   點擊 `Set Anchor B (End)`。
3.  **鎖定同步**:
    *   將 Sync Widget 上的 `Lock Sync` 勾選起來。
    *   現在拖動影片進度條，波形圖就會跟著連動了！

### 步驟 3: 開始標註 (Labeling)
1.  **移動至擊球點**:
    *   方式 A: 拖動影片進度條。
    *   方式 B: 在波形圖上拖動黃色游標。
    *   方式 C (**推薦**): 使用上方 `Next Peak (>>)` 按鈕，自動跳至下一個波峰。
2.  **按下標註鍵**:
    *   使用鍵盤熱鍵 `1` ~ `5`，或點擊下方按鈕：
        *   `1`: Smash (殺球)
        *   `2`: Drive (平球)
        *   `3`: Toss (挑球)
        *   `4`: Drop (切球)
        *   `5`: Other (其他)
3.  **確認結果**:
    *   波形圖上會出現一條**實線**（代表標註時間點）。
    *   實線後方會有**淡灰色區域**（代表擷取的資料範圍，預設前30/後9 frames）。
4.  **復原**:
    *   如果不小心標錯，按 `Z` 鍵或點擊 `Undo (Z)` 即可復原上一步。

### 步驟 4: 輸出
*   所有標註會即時自動存入 `labels/` 資料夾下的 `.jsonl` 檔案中。不需手動存檔。

---

## 3. 進階設定 (Advanced)

### 自訂擷取視窗 (Config Window)
如果您需要改變擷取資料的長度：
1.  點擊下方按鈕列右側的 `⚙ Config`。
2.  **Pre-Window**: 擊球點**前**預留的 Frame 數 (預設 30)。
3.  **Post-Window**: 擊球點**後**預留的 Frame 數 (預設 9)。
4.  按下 OK 後，新的標註將採用此設定。

### 讀取舊標註 (Load Labels)
如果您想要檢查之前的標註：
1.  點選選單 `File` -> `Load Labels...`。
2.  選擇對應的 `.jsonl` 檔案。
3.  程式會將所有標註點與灰色範圍重新畫在波形圖上。

### 智慧導航設定
*   **Threshold (g)**: 設定加速度閾值 (預設 3.0g)。只有超過此強度的波峰會被視為擊球點。

---

## 4. 常見問題 (FAQ)
*   **Q: 為什麼標註線跟黃色游標沒有對齊？**
    *   A: 請確認您使用的是最新版本，新版已修正此問題，標註線會精確地畫在您當下看見的游標位置。
*   **Q: 資料缺失率 (Missing Rate) 很高？**
    *   A: 這表示硬體傳回的數據頻率低於 50Hz。程式會自動補值，但建議檢查硬體設定。

---

## 5. 故障排除 (Troubleshooting)

### 錯誤：Failed to load Python DLL (python311.dll)
*   **現象**: 啟動時跳出錯誤視窗，顯示 `LoadLibrary: 找不到指定的模組`。
*   **原因**: 原廠 Windows 可能缺少必要的微軟基礎函式庫 (Visual C++ Redistributable)。
*   **解決方法**: 
    1.  請下載並安裝最新的 **[Microsoft Visual C++ Redistributable (x64)](https://aka.ms/vs/17/release/vc_redist.x64.exe)**。
    2.  安裝完成後，重新執行程式即可。

